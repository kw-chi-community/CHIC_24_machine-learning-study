### [ğŸ”— 2-2. ë°ì´í„° ì „ì²˜ë¦¬ Colab](https://colab.research.google.com/drive/1CeuMTCGdlYYBBBT4l6dQmaJsu-6cfoqM?usp=sharing)   
---
ë°ì´í„° ì „ì²˜ë¦¬ : ëª¨ë¸ì— í›ˆë ¨ ë°ì´í„°ë¥¼ ì£¼ì…í•˜ê¸° ì „ ê°€ê³µí•˜ëŠ” ë‹¨ê³„

í‘œì¤€ì ìˆ˜ : í›ˆë ¨ ì„¸íŠ¸ì˜ ìŠ¤ì¼€ì¼ì„ ë°”ê¾¸ëŠ” ë°©ë²•, ê° ë°ì´í„°ê°€ ì›ì ì—ì„œ ëª‡ í‘œì¤€í¸ì°¨ë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’

**í›ˆë ¨ ì„¸íŠ¸**ì˜ í‰ê· ê³¼ í‘œì¤€ì°¨ë¡œ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¥¼ ë°”ê¿”ì•¼í•¨

ë¸Œë¡œë“œìºìŠ¤íŒ… : í¬ê¸°ê°€ ë‹¤ë¥¸ ë„˜íŒŒì´ ë°°ì—´ì—ì„œ ìë™ìœ¼ë¡œ ì‚¬ì¹™ ì—°ì‚°ì„ ëª¨ë“  í–‰ì´ë¼ ì—´ë¡œ í™•ì¥í•´ ìˆ˜í–‰

---
scikit-learn
- train_test_split()
  : í›ˆë ¨ ë°ì´í„°ë¥¼ í›ˆë ¨ ì„¸íŠ¸ì™€ í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ë¡œ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜, test_size ë¡œ í…ŒìŠ¤íŠ¸ ë‚˜ëˆŒ ë¹„ìœ¨ ì§€ì • ê°€ëŠ¥, ê¸°ë³¸ê°’ : 25%

- kneighbors() : K-ìµœê·¼ì ‘ ì´ì›ƒ ê°í…Œì˜ ë©”ì„œë“œ, ì…ë ¥í•œ ë°ì´í„°ì— ê°€ì¥ ê°€ê¹Œìš´ ì´ì›ƒì„ ì°¾ì•„ **ê±°ë¦¬ì™€ ì´ì›ƒ ìƒ˜í”Œì˜ ì¸ë±ìŠ¤** ë°˜í™˜

--- 
ì‹¤ìŠµ ì„¤ëª…
### ë„˜íŒŒì´ë¡œ ë°ì´í„° ì¤€ë¹„
```python
# ë¦¬ìŠ¤íŠ¸ ë‚´í¬ ëŒ€ì‹  ë„˜íŒŒì´ .column_stack() ì‚¬ìš©
import numpy as np
fish_data = np.column_stack((fish_length, fish_weight))
fish_data

# íƒ€ê¹ƒ ë°ì´í„° ë§Œë“¤ê¸° np.concatenate() ê·¸ëŒ€ë¡œ ì—°ê²°
fish_target = np.concatenate((np.ones(35), np.zeros(14)))
# ì¶œë ¥ : [1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1.
 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 1. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0. 0.
 0.]
```
### ì‚¬ì´í‚·ëŸ°ìœ¼ë¡œ ì„¸íŠ¸ ë‚˜ëˆ„ê¸°
```python
# train_test_split() : ë‚˜ëˆ„ê³ ì‹¶ì€ ë°°ì—´ì„ ì›í•˜ëŠ” ë§Œí¼ ì „ë‹¬
train_input, test_input, train_target, test_target = train_test_split(
    fish_data, fish_target, random_state=42)
# fish_dataëŠ” train_input, test_input ìœ¼ë¡œ, fish_targetì€ train_target, test_target ìœ¼ë¡œ
```
ë¬´ì‘ìœ„ë¡œ ë‚˜ëˆ´ì„ ë•Œ ìƒ˜í”Œì´ ê³¨ê³ ìš° ì„ì´ì§€ ì•Šì„ ìˆ˜ ìˆìŒ

-> **stratify ë§¤ê°œë³€ìˆ˜ì— íƒ€ê¹ƒ ë°ì´í„° ì „ë‹¬í•˜ë©´ í•´ê²°**
```python
# stratify=fish_target ì§€ì •
train_input, test_input, train_target, test_target = train_test_split(
    fish_data, fish_target, stratify=fish_target, random_state=42)
```

### ê¸°ì¤€ì„ ë§ì¶°ë¼
```python
# xì¶•, yì¶• ë²”ìœ„ ë™ì¼í•˜ê²Œ ë§ì¶”ê¸°
plt.scatter(train_input[:,0], train_input[:,1])
plt.scatter(25, 150, marker='^')
plt.scatter(train_input[indexes,0], train_input[indexes,1], marker='D')
plt.xlim((0, 1000))
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
![image](https://github.com/SYEONIH/CHIC_24_machine-learning-study/assets/113624562/3e0fad6b-d175-466b-a071-66dbe42b64b1)

```python
# mean : í‰ê· , std : í‘œì¤€í¸ì°¨
mean = np.mean(train_input, axis=0)
std = np.std(train_input, axis=0)
print(mean, std)
# ì¶œë ¥ : [ 27.29722222 454.09722222] [  9.98244253 323.29893931]

# í‘œì¤€ì ìˆ˜ : ê° ë°ì´í„°ê°€ ì›ì ì—ì„œ ëª‡ í‘œì¤€í¸ì°¨ë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ”ì§€ë¥¼ ë‚˜íƒ€ë‚´ëŠ” ê°’
train_scaled = (train_input - mean) / std
```


### ì „ì²˜ë¦¬ ë°ì´í„°ë¡œ ëª¨ë¸ í›ˆë ¨í•˜ê¸°
```python
# í‘œì¤€ ì ìˆ˜ë¡œ ë°˜í™˜ -> ë²”ìœ„ê°€ ë‹¬ë¼ì„œ ì´ìƒí•¨ ( ìƒ˜í”Œ [25, 150] ë™ì¼ ë¹„ìœ¨ë¡œ ë°˜í™˜ í•„ìš” )
plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(25, 150, marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
![image](https://github.com/SYEONIH/CHIC_24_machine-learning-study/assets/113624562/551c5e07-06cb-4447-8831-e9adc71a7349)

```python
# ìƒ˜í”Œ [25, 150] ë™ì¼ ë¹„ìœ¨ë¡œ ë°˜í™˜
new = ([25, 150] - mean) / std

plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(new[0], new[1], marker='^')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
![image](https://github.com/SYEONIH/CHIC_24_machine-learning-study/assets/113624562/6e960acc-6170-43ca-8e93-74a351bc21a1)

```python
kn.fit(train_scaled, train_target)
test_scaled = (test_input - mean) / std
kn.score(test_scaled, test_target)

# ë„ë¯¸ë¡œ ì˜ˆì¸¡ : [1.]
print(kn.predict([new]))
```
```python
# ì‹œê°í™”
distances, indexes = kn.kneighbors([new])

plt.scatter(train_scaled[:,0], train_scaled[:,1])
plt.scatter(new[0], new[1], marker='^')
plt.scatter(train_scaled[indexes,0], train_scaled[indexes,1], marker='D')
plt.xlabel('length')
plt.ylabel('weight')
plt.show()
```
![image](https://github.com/SYEONIH/CHIC_24_machine-learning-study/assets/113624562/6bba84fd-90fb-44b9-bf6e-a945690c8076)

---
## í™•ì¸ ë¬¸ì œ
1. ì´ ë°©ì‹ì€ ìŠ¤ì¼€ì¼ ì¡°ì • ë°©ì‹ì˜ í•˜ë‚˜ë¡œ íŠ¹ì„±ê°’ì„ 0ì—ì„œ í‘œì¤€í¸ì°¨ì˜ ëª‡ ë°°ìˆ˜ë§Œí¼ ë–¨ì–´ì ¸ ìˆëŠ” ì§€ë¡œ ë³€í™˜í•˜ëŠ” ê°’ì…ë‹ˆë‹¤. ì´ ê°’ì„ ë¬´ì—‡ì´ë¼ ë¶€ë¥´ë‚˜ìš”?<details>**í‘œì¤€ì ìˆ˜**<summary>ì •ë‹µ
</summary></details>

2. í…ŒìŠ¤íŠ¸ ì„¸íŠ¸ì˜ ìŠ¤ì¼€ì¼ì„ ì¡°ì •í•˜ë ¤ê³  í•©ë‹ˆë‹¤.  ë‹¤ìŒ ì¤‘ ì–´ë–¤ ë°ì´í„°ì˜ í†µê³„ ê°’ì„ ì‚¬ìš©í•´ì•¼ í•˜ë‚˜ìš”?<details>**í›ˆë ¨ ì„¸íŠ¸**<summary>ì •ë‹µ
</summary></details>
